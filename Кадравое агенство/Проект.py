"""
ПРОГРАММА "КАДРОВОЕ АГЕНТСТВО"
Управление базой данных соискателей
Использует шейкерную сортировку для формирования отчетов
"""

   # Создание начальной базы данных с тестовыми записями.
def создать_базу():
    return [
        # Программисты
        ["Иванов", "Иван", "Иванович", "М", 1985, 5, 15, "Программист", 10, "Английский", 150000],
        ["Петров", "Петр", "Петрович", "М", 1990, 8, 22, "Программист", 5, "Английский", 120000],
        ["Сидорова", "Анна", "Сергеевна", "Ж", 1992, 3, 10, "Программист", 3, "Английский,Французский", 100000],
        ["Борисов", "Владимир", "Сергеевич", "М", 1983, 10, 17, "Программист", 12, "Английский,Китайский", 170000],
        ["Захарова", "Ирина", "Борисовна", "Ж", 1989, 7, 3, "Программист", 8, "Английский,Японский", 140000],
        ["Жуков", "Жан", "Жданович", "М", 1993, 7, 19, "Программист", 4, "Английский", 105000],
        ["Белов", "Борис", "Борисович", "М", 1972, 8, 14, "Программист", 22, "Английский,Немецкий,Французский", 200000],

        # Менеджеры
        ["Кузнецов", "Алексей", "Андреевич", "М", 1988, 11, 30, "Менеджер", 8, "Английский", 90000],
        ["Смирнова", "Елена", "Владимировна", "Ж", 1995, 7, 18, "Менеджер", 2, "Английский,Испанский", 70000],
        ["Григорьев", "Павел", "Анатольевич", "М", 1996, 5, 20, "Менеджер", 1, "Английский", 60000],
        ["Романова", "Светлана", "Дмитриевна", "Ж", 1990, 11, 11, "Менеджер", 5, "Английский,Французский", 80000],
        ["Зиновьева", "Зоя", "Зиновьевна", "Ж", 1988, 2, 27, "Менеджер", 7, "Английский,Итальянский", 85000],

        # Аналитики
        ["Васильев", "Дмитрий", "Николаевич", "М", 1980, 1, 5, "Аналитик", 15, "Английский,Немецкий", 180000],
        ["Николаева", "Ольга", "Игоревна", "Ж", 1993, 9, 25, "Аналитик", 4, "Английский", 110000],
        ["Кириллов", "Михаил", "Олегович", "М", 1982, 8, 9, "Аналитик", 13, "Английский,Испанский", 160000],
        ["Тимофеева", "Надежда", "Петровна", "Ж", 1985, 3, 14, "Аналитик", 10, "Английский,Немецкий", 135000],
        ["Ильин", "Илья", "Ильич", "М", 1991, 10, 13, "Аналитик", 6, "Английский", 115000],

        # Дизайнеры
        ["Алексеев", "Сергей", "Васильевич", "М", 1975, 12, 3, "Дизайнер", 20, "Английский", 130000],
        ["Федорова", "Мария", "Александровна", "Ж", 1987, 4, 12, "Дизайнер", 7, "Английский,Итальянский", 95000],
        ["Артемьев", "Артем", "Артемьевич", "М", 1978, 6, 23, "Дизайнер", 18, "Английский", 125000],
        ["Владимирова", "Вера", "Ивановна", "Ж", 1992, 4, 5, "Дизайнер", 5, "Английский,Французский", 90000],
        ["Яковлев", "Яков", "Яковлевич", "М", 1970, 12, 31, "Дизайнер", 25, "Английский,Немецкий", 150000],

        # Тестировщики
        ["Дмитриев", "Андрей", "Павлович", "М", 1991, 6, 8, "Тестировщик", 6, "Английский", 85000],
        ["Орлова", "Татьяна", "Викторовна", "Ж", 1994, 2, 28, "Тестировщик", 2, "Английский", 65000],
        ["Геннадьев", "Геннадий", "Геннадьевич", "М", 1986, 9, 30, "Тестировщик", 9, "Английский", 95000],
        ["Егорова", "Екатерина", "Егоровна", "Ж", 1995, 1, 8, "Тестировщик", 3, "Английский", 70000],
        ["Антонова", "Антонина", "Антоновна", "Ж", 1984, 5, 7, "Тестировщик", 11, "Английский,Испанский", 110000]
    ]


def показать_запись(номер, запись):

    #Вывод одной записи соискателя в форматированном виде.
    print(f"{номер:2d}. {запись[0]:12} {запись[1]:10} {запись[2]:15} "
          f"{запись[3]:2} {запись[6]:02d}.{запись[5]:02d}.{запись[4]} "
          f"{запись[7]:15} {запись[8]:5.1f} лет "
          f"{запись[9]:25} {запись[10]:10,} руб.")

def показать_базу(база, заголовок="ВСЯ БАЗА ДАННЫХ"):

    #Вывод всей базы данных с заголовком.
    if not база:
        print("\nБаза данных пуста!")
        return

    print(f"\n{'=' * 100}")
    print(f"{заголовок}")
    print(f"{'=' * 100}")
    print(f"{'№':3} {'Фамилия':12} {'Имя':10} {'Отчество':15} {'Пол':2} "
          f"{'Дата':10} {'Специальность':15} {'Стаж':7} {'Языки':25} {'Оклад':10}")
    print(f"{'-' * 100}")

    for i, запись in enumerate(база, 1):
        показать_запись(i, запись)

    print(f"{'=' * 100}")
    print(f"Всего записей: {len(база)}")

def шейкерная_сортировка(список, ключи, направления):

    #Реализация шейкерной сортировки
    n = len(список)
    if n <= 1:
        return список

    левый = 0
    правый = n - 1

    while левый <= правый:
        # Проход слева направо
        for i in range(левый, правый):
            менять = False
            # Сравниваем по всем ключам
            for k in range(len(ключи)):
                значение1 = ключи[k](список[i])
                значение2 = ключи[k](список[i + 1])

                if значение1 != значение2:
                    # Определяем нужно ли менять элементы
                    if (not направления[k] and значение1 > значение2) or \
                            (направления[k] and значение1 < значение2):
                        менять = True
                    break

            if менять:
                # Меняем элементы местами
                список[i], список[i + 1] = список[i + 1], список[i]

        правый -= 1

        # Проход справа налево
        for i in range(правый, левый, -1):
            менять = False
            for k in range(len(ключи)):
                значение1 = ключи[k](список[i - 1])
                значение2 = ключи[k](список[i])

                if значение1 != значение2:
                    if (not направления[k] and значение1 > значение2) or \
                            (направления[k] and значение1 < значение2):
                        менять = True
                    break

            if менять:
                список[i], список[i - 1] = список[i - 1], список[i]

        левый += 1

    return список

def ввод_числа(сообщение, мин=None, макс=None):
    while True:
        try:
            значение = int(input(сообщение))

            # Проверка минимального значения
            if мин is not None and значение < мин:
                print(f"Число должно быть не меньше {мин}")
                continue

            # Проверка максимального значения
            if макс is not None and значение > макс:
                print(f"Число должно быть не больше {макс}")
                continue

            return значение

        except ValueError:
            print("Ошибка! Введите целое число.")

def добавить_запись(база):

    #Добавление новой записи в базу данных.
    #Запрашивает у пользователя все необходимые данные.
    print("\n" + "=" * 50)
    print("ДОБАВЛЕНИЕ НОВОЙ ЗАПИСИ")
    print("=" * 50)

    # Ввод фамилии с проверкой
    фамилия = input("Фамилия: ").strip()
    while not фамилия:
        print("Фамилия не может быть пустой!")
        фамилия = input("Фамилия: ").strip()

    # Ввод имени с проверкой
    имя = input("Имя: ").strip()
    while not имя:
        print("Имя не может быть пустым!")
        имя = input("Имя: ").strip()

    # Ввод отчества
    отчество = input("Отчество: ").strip()

    # Ввод пола с проверкой
    пол = input("Пол (М/Ж): ").upper()
    while пол not in ["М", "Ж"]:
        print("Пол должен быть 'М' или 'Ж'!")
        пол = input("Пол (М/Ж): ").upper()

    # Ввод даты рождения
    print("\nДата рождения:")
    год = ввод_числа("  Год: ", 1900, 2024)
    месяц = ввод_числа("  Месяц (1-12): ", 1, 12)
    день = ввод_числа("  День (1-31): ", 1, 31)

    # Ввод специальности с проверкой
    специальность = input("\nСпециальность: ").strip()
    while not специальность:
        print("Специальность не может быть пустой!")
        специальность = input("Специальность: ").strip()

    # Ввод стажа
    стаж = ввод_числа("Стаж работы (лет): ", 0, 100)

    # Ввод языков
    языки = input("Иностранные языки (через запятую): ").strip()

    # Ввод оклада
    оклад = ввод_числа("Ожидаемый оклад (руб.): ", 1, 1000000)

    # Создание и добавление новой записи
    новая_запись = [фамилия, имя, отчество, пол, год, месяц, день,
                    специальность, стаж, языки, оклад]
    база.append(новая_запись)

    print(f"\nЗапись успешно добавлена! Всего записей: {len(база)}")
    return база


def удалить_запись(база):

    #Удаление записи из базы данных по номеру.
    if not база:
        print("\nБаза данных пуста!")
        return база

    # Показываем базу для выбора записи
    показать_базу(база, "ВЫБОР ЗАПИСИ ДЛЯ УДАЛЕНИЯ")

    # Запрашиваем номер записи
    номер = ввод_числа(f"\nВведите номер записи для удаления (1-{len(база)}): ", 1, len(база))

    # Удаляем запись
    удаленная = база.pop(номер - 1)
    print(f"\nЗапись удалена: {удаленная[0]} {удаленная[1]}")
    print(f"Осталось записей: {len(база)}")

    return база

def изменить_запись(база):

    #Изменение существующей записи в базе данных.
    if not база:
        print("\nБаза данных пуста!")
        return база

    # Показываем базу для выбора записи
    показать_базу(база, "ВЫБОР ЗАПИСИ ДЛЯ ИЗМЕНЕНИЯ")

    # Запрашиваем номер записи
    номер = ввод_числа(f"\nВведите номер записи для изменения (1-{len(база)}): ", 1, len(база))

    # Получаем текущую запись
    запись = база[номер - 1]
    print(f"\nИзменение записи: {запись[0]} {запись[1]}")
    print("Введите новые значения (оставьте пустым для сохранения старого):")

    # Ввод новых значений с возможностью оставить старые
    новая_фамилия = input(f"Фамилия [{запись[0]}]: ").strip() or запись[0]
    новое_имя = input(f"Имя [{запись[1]}]: ").strip() or запись[1]
    новое_отчество = input(f"Отчество [{запись[2]}]: ").strip() or запись[2]

    новый_пол = input(f"Пол (М/Ж) [{запись[3]}]: ").strip().upper()
    if новый_пол not in ["М", "Ж"]:
        новый_пол = запись[3]

    # Ввод даты с возможностью оставить старую
    try:
        ввод_год = input(f"Год рождения [{запись[4]}]: ").strip()
        новый_год = int(ввод_год) if ввод_год else запись[4]
    except:
        новый_год = запись[4]

    try:
        ввод_месяц = input(f"Месяц [{запись[5]}]: ").strip()
        новый_месяц = int(ввод_месяц) if ввод_месяц else запись[5]
    except:
        новый_месяц = запись[5]

    try:
        ввод_день = input(f"День [{запись[6]}]: ").strip()
        новый_день = int(ввод_день) if ввод_день else запись[6]
    except:
        новый_день = запись[6]

    новая_специальность = input(f"Специальность [{запись[7]}]: ").strip() or запись[7]

    try:
        ввод_стаж = input(f"Стаж [{запись[8]}]: ").strip()
        новый_стаж = float(ввод_стаж) if ввод_стаж else запись[8]
    except:
        новый_стаж = запись[8]

    новые_языки = input(f"Языки [{запись[9]}]: ").strip() or запись[9]

    try:
        ввод_оклад = input(f"Оклад [{запись[10]}]: ").strip()
        новый_оклад = int(ввод_оклад) if ввод_оклад else запись[10]
    except:
        новый_оклад = запись[10]

    # Обновление записи
    база[номер - 1] = [новая_фамилия, новое_имя, новое_отчество, новый_пол,
                       новый_год, новый_месяц, новый_день, новая_специальность,
                       новый_стаж, новые_языки, новый_оклад]

    print("\nЗапись успешно изменена!")
    return база

def отчет_1(база):

    #Формирование отчета 1:
    if not база:
        print("\nБаза данных пуста!")
        return

    # Создаем копию базы для сортировки
    отсортированная = база.copy()

    # Определяем ключи сортировки
    ключ_специальность = lambda x: x[7]  # индекс 7 - специальность
    ключ_фамилия = lambda x: x[0]  # индекс 0 - фамилия

    # Выполняем шейкерную сортировку по двум ключам
    отсортированная = шейкерная_сортировка(
        отсортированная,
        [ключ_специальность, ключ_фамилия],
        [False, False]  # оба по возрастанию
    )

    # Выводим результат
    показать_базу(отсортированная, "ОТЧЕТ 1: СПЕЦИАЛЬНОСТЬ↑ + ФАМИЛИЯ↑")


def отчет_2(база):

    #Формирование отчета 2
    if not база:
        print("\nБаза данных пуста!")
        return

    # Получаем список всех специальностей
    специальности = []
    for запись in база:
        if запись[7] not in специальности:
            специальности.append(запись[7])

    # Показываем доступные специальности
    print("\nДоступные специальности:")
    for i, спец in enumerate(sorted(специальности), 1):
        print(f"  {i}. {спец}")

    # Запрашиваем специальность
    выбор = input("\nВведите название специальности: ").strip()
    if not выбор:
        print("Специальность не указана!")
        return

    # Фильтруем записи по выбранной специальности
    отфильтрованные = []
    for запись in база:
        if запись[7].lower() == выбор.lower():
            отфильтрованные.append(запись)

    if not отфильтрованные:
        print(f"\nСоискателей со специальностью '{выбор}' не найдено")
        return

    # Определяем ключи сортировки
    ключ_стаж = lambda x: x[8]  # индекс 8 - стаж
    ключ_пол = lambda x: 0 if x[3] == "М" else 1  # М=0, Ж=1 для сортировки по убыванию
    ключ_фамилия = lambda x: x[0]  # индекс 0 - фамилия

    # Выполняем сортировку по трем ключам
    отсортированная = шейкерная_сортировка(
        отфильтрованные,
        [ключ_стаж, ключ_пол, ключ_фамилия],
        [True, True, False]  # стаж и пол по убыванию, фамилия по возрастанию
    )

    # Выводим результат
    заголовок = f"ОТЧЕТ 2: {выбор.upper()} (СТАЖ↓ + ПОЛ↓ + ФАМИЛИЯ↑)"
    показать_базу(отсортированная, заголовок)


def отчет_3(база):

    #Формирование отчета 3:
    if not база:
        print("\nБаза данных пуста!")
        return

    # Запрашиваем диапазон окладов
    print("\nВведите диапазон оклада:")
    n1 = ввод_числа("  От (руб.): ", 0)
    n2 = ввод_числа("  До (руб.): ", n1)

    # Фильтруем записи по диапазону оклада
    отфильтрованные = []
    for запись in база:
        if n1 <= запись[10] <= n2:
            отфильтрованные.append(запись)

    if not отфильтрованные:
        print(f"\nСоискателей с окладом от {n1} до {n2} руб. не найдено")
        return

    # Определяем ключи сортировки
    ключ_оклад = lambda x: x[10]  # индекс 10 - оклад
    ключ_фамилия = lambda x: x[0]  # индекс 0 - фамилия

    # Выполняем сортировку по двум ключам
    отсортированная = шейкерная_сортировка(
        отфильтрованные,
        [ключ_оклад, ключ_фамилия],
        [True, False]  # оклад по убыванию, фамилия по возрастанию
    )

    # Выводим результат
    заголовок = f"ОТЧЕТ 3: ОКЛАД {n1}-{n2} РУБ. (ОКЛАД↓ + ФАМИЛИЯ↑)"
    показать_базу(отсортированная, заголовок)

def главное_меню():
    # Инициализация базы данных
    база = создать_базу()
    print("=" * 60)
    print("ПРОГРАММА 'КАДРОВОЕ АГЕНТСТВО'")
    print("=" * 60)
    print(f"База данных инициализирована. Записей: {len(база)}")

    while True:
        # Отображение меню
        print("\n" + "=" * 60)
        print("ГЛАВНОЕ МЕНЮ")
        print("=" * 60)
        print("1. Показать всю базу данных")
        print("2. Добавить запись")
        print("3. Удалить запись")
        print("4. Изменить запись")
        print("5. Отчет 1: Специальность + Фамилия")
        print("6. Отчет 2: По специальности")
        print("7. Отчет 3: По диапазону оклада")
        print("8. Выход")
        print("=" * 60)

        try:
            # Получение выбора пользователя
            выбор = int(input("Выберите действие (1-8): "))

            # Обработка выбора
            if выбор == 1:
                показать_базу(база)
            elif выбор == 2:
                база = добавить_запись(база)
            elif выбор == 3:
                база = удалить_запись(база)
            elif выбор == 4:
                база = изменить_запись(база)
            elif выбор == 5:
                отчет_1(база)
            elif выбор == 6:
                отчет_2(база)
            elif выбор == 7:
                отчет_3(база)
            elif выбор == 8:
                # Завершение программы
                print("\n" + "=" * 60)
                print("Работа программы завершена")
                print(f"Всего записей в базе: {len(база)}")
                print("До свидания!")
                print("=" * 60)
                break
            else:
                print("\nОшибка: выберите число от 1 до 8")

        except ValueError:
            print("\nОшибка: введите число от 1 до 8")

        # Пауза для просмотра результатов
        if выбор != 8:
            input("\nНажмите Enter для продолжения...")

if __name__ == "__main__":
    главное_меню()




